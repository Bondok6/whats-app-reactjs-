(this["webpackJsonpwhats-app"]=this["webpackJsonpwhats-app"]||[]).push([[0],{101:function(e,t,n){e.exports=n(175)},106:function(e,t,n){},107:function(e,t,n){},108:function(e,t,n){},130:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},135:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},169:function(e,t){},175:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(26),o=n.n(c),s=(n(106),n(107),n(31)),i=n(18),l=n(19),u=n(21),m=n(20),d=(n(108),function(e){var t=null,n=["inputElement"];switch(e.inValid&&e.hasValidity&&e.touched&&n.push("Invalid"),e.elementType){case"input":t=r.a.createElement("input",Object.assign({className:n.join(" ")},e.elementConfig,{value:e.value,onChange:e.changed}));break;case"textarea":t=r.a.createElement("textarea",Object.assign({className:n.join(" ")},e.elementConfig,{value:e.value,onChange:e.changed}));break;case"select":t=r.a.createElement("select",{className:n.join(" "),value:e.value,onChange:e.changed},e.elementConfig.options.map((function(e){return r.a.createElement("option",{key:e.value,value:e.value},e.displayValue," ")})));break;default:t=r.a.createElement("input",Object.assign({className:n.join(" ")},e.elementConfig,{value:e.value}))}return r.a.createElement("div",{className:"Input"},r.a.createElement("label",{className:"label"}," ",e.label," "),t)}),p=n(2);function f(e,t,n){var a,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"id",c=document.createElement("span"),o=document.createElement("span");return c.setAttribute("class","chat__name"),c.textContent="time",o.setAttribute("class","chat__timestamp"),o.setAttribute("style","overflow:hidden"),o.textContent=e,c.after(e),c.after(o),e.endsWith("png")||e.endsWith("jpg")||e.endsWith("PNG")||e.endsWith("JPG")||"img"===n?((a=document.createElement("img")).setAttribute("src",e),"img"===n&&a.setAttribute("style","background-color:yellow"),t?a.setAttribute("class","chat__message chat__reciever ".concat(r)):a.setAttribute("class","chat__message"),a.appendChild(c),a):e.endsWith("wav")||e.endsWith("mp3")||"voice"===n?((a=document.createElement("audio")).setAttribute("src",e),a.setAttribute("controls","controls"),a.setAttribute("id","audio"),"voice"===n&&a.setAttribute("style","background-color:yellow"),t?a.setAttribute("class","chat__message chat__reciever ".concat(r)):a.setAttribute("class","chat__message"),a.appendChild(c),a):((a=document.createElement("p")).setAttribute("key",r),t?a.setAttribute("class","chat__message chat__reciever"):a.setAttribute("class","chat__message"),a.appendChild(c),a.textContent=e,a)}var h=function(e,t){return Object(p.a)(Object(p.a)({},e),t)},b=function(e,t){var n=!0;if(!t)return!0;if(t.required&&(n=""!==e.trim()&&n),t.minLength&&(n=e.length>=t.minLength&&n),t.maxLength&&(n=e.length<=t.maxLength&&n),t.isEmail){n=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e)&&n}if(t.isNumeric){n=/^\d+$/.test(e)&&n}return n},g=n(10),v=n.n(g),y=n(22),E=n(84),O=n.n(E).a.create({baseURL:"http://localhost:9004"}),j=function(e,t,n){return{type:"AUTH_SUCCESS",token:e,photo:n,userId:t}},k=function(e){return{type:"AUTH_FAIL",error:e}},C=function(){return localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("expirationDate"),{type:"LOGOUT"}},_=function(e){return function(t){setTimeout((function(){t(C())}),1e3*e)}},S=function(e){return{type:"FETCH_ROOM_SUCCESS",rooms:e}},w=function(e){return function(){var e=Object(y.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"FETCH_ROOM_START"}),e.next=3,O.get("/rooms",{headers:{authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:n=e.sent,a=n.data,200!==n.status&&201!==n.status?t({type:"FETCH_ROOM_FAIL",error:a}):t(S(a));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=function(e,t){return{type:"ROOM_SUCCESS",room:e,id:t}},R=function(e,t){return{type:"ROOM_FAIL",error:e,id:t}},A=function(e){return function(){var t=Object(y.a)(v.a.mark((function t(n){var a,r,c;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(a=new FormData).append("photo",e),t.next=5,O("http://localhost:9004/message",a);case 5:return r=t.sent,t.next=8,r.data;case 8:c=t.sent,console.log(c),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()},N=n(5),I=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={controls:{email:{value:"",valid:!1,validation:{required:!0,isEmail:!0},elementType:"input",elementConfig:{type:"email",placeholder:"Email"},touched:!1},password:{value:"",valid:!1,validation:{required:!0,maxLength:6},elementType:"input",elementConfig:{type:"password",placeholder:"Password"},touched:!1}}},e.submit=function(t){t.preventDefault(),e.props.signIn(e.state.controls.email.value,e.state.controls.password.value)},e}return Object(l.a)(n,[{key:"on",value:function(e,t){var n=h(this.state.controls,Object(s.a)({},t,h(this.state.controls[t],{valid:b(e.target.value,this.state.controls[t].validation),value:e.target.value,touched:!0})));this.setState({controls:n})}},{key:"render",value:function(){var e=this,t=[];for(var n in this.state.controls)t.push({id:n,config:this.state.controls[n]});var a=t.map((function(t){return r.a.createElement(d,{key:t.id,changed:function(n){return e.on(n,t.id)},inValid:!t.config.valid,value:t.config.value,elementType:t.config.elementType,hasValidity:!0,touched:t.config.touched,elementConfig:t.config.elementConfig})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"text-center"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row m-5 m-5 m-5"},r.a.createElement("div",{className:"col-4"}),r.a.createElement("form",{className:"form-signin"},r.a.createElement("h1",{className:"h3 mb-3 font-weight-normal"},"Please sign ip"),a,r.a.createElement("button",{className:"btn btn-lg btn-primary btn-block mt-3",type:"submit",onClick:this.submit},"Submit"))))))}}]),n}(a.Component),x=Object(N.b)((function(e){return{}}),(function(e){return{signIn:function(t,n){return e(function(e,t){return function(){var n=Object(y.a)(v.a.mark((function n(a){var r,c,o;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a({type:"AUTH_START"}),n.next=4,O.post("/login",{email:e,password:t});case 4:return r=n.sent,n.next=7,r.data;case 7:c=n.sent,200!==r.status&&201!==r.status?a(k(c.msg)):(o=new Date((new Date).getTime()+1e3*c.expiresIn),localStorage.setItem("token",c.token),localStorage.setItem("userId",c.user.id),localStorage.setItem("expirationDate",o),a(j(c.token,c.user.id,c.user.photo)),a(_(c.expiresIn))),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),a(k(n.t0));case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()}(t,n))}}}))(I),U=(n(130),function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={controls:{username:{value:"",valid:!1,validation:{required:!0,minLength:6,maxLength:12},elementType:"input",elementConfig:{type:"username",placeholder:"Username"},touched:!1},email:{value:"",valid:!1,validation:{required:!0,isEmail:!0},elementType:"input",elementConfig:{type:"email",placeholder:"Email"},touched:!1},password:{value:"",valid:!1,validation:{required:!0,maxLength:6},elementType:"input",elementConfig:{type:"password",placeholder:"Password"},touched:!1}},photo:null},e.submit=function(t){t.preventDefault(),e.props.signUp(e.state.photo,e.state.controls.username.value,e.state.controls.email.value,e.state.controls.password.value)},e}return Object(l.a)(n,[{key:"on",value:function(e,t){var n=h(this.state.controls,Object(s.a)({},t,h(this.state.controls[t],{valid:b(e.target.value,this.state.controls[t].validation),value:e.target.value,touched:!0})));this.setState({controls:n})}},{key:"render",value:function(){var e=this,t=[];for(var n in this.state.controls)t.push({id:n,config:this.state.controls[n]});var a=t.map((function(t){return r.a.createElement(d,{key:t.id,changed:function(n){return e.on(n,t.id)},inValid:!t.config.valid,value:t.config.value,elementType:t.config.elementType,hasValidity:!0,touched:t.config.touched,elementConfig:t.config.elementConfig})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"text-center"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row m-5 m-5 m-5"},r.a.createElement("div",{className:"col-4"}),r.a.createElement("form",{className:"form-signin"},r.a.createElement("h1",{className:"h3 mb-3 font-weight-normal"},"Please sign up"),r.a.createElement("img",{id:"img",alt:"ss",style:{borderRadius:"50%",width:"62px",height:"55px"},className:"hidden"}),r.a.createElement("input",{id:"phoo",type:"file",onChange:function(t){if(t.target.files[0]){e.setState({photo:t.target.files[0]});var n=t.target.files[0],a=new FileReader,r=document.getElementById("img");r.classList.remove("hidden"),r.title=n.name,a.onload=function(e){r.src=e.target.result},a.readAsDataURL(n)}}}),a,r.a.createElement("button",{className:"btn btn-lg btn-primary btn-block mt-3",type:"submit",onClick:this.submit},"Submit"))))))}}]),n}(a.Component)),F=Object(N.b)((function(e){return{}}),(function(e){return{signUp:function(t,n,a,r){return e(function(e,t,n,a){return function(){var r=Object(y.a)(v.a.mark((function r(c){var o,s,i;return v.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,c({type:"AUTH_START"}),(o=new FormData).append("photo",e),o.append("username",t),o.append("email",n),o.append("password",a),r.next=9,O.post("/signup",o);case 9:200!==(s=r.sent).status&&201!==s.status?c(k(s.data.msg)):(i=new Date((new Date).getTime()+1e3*s.data.expiresIn),localStorage.setItem("token",s.data.token),localStorage.setItem("userId",s.data.user.id),localStorage.setItem("expirationDate",i),c(j(s.data.token,s.data.user.id,s.data.user.photo)),c(_(s.data.expiresIn))),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(0),c(k(r.t0));case 16:case"end":return r.stop()}}),r,null,[[0,13]])})));return function(e){return r.apply(this,arguments)}}()}(t,n,a,r))},message:function(t){return e(A(t))}}}))(U);var L=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(x,null),r.a.createElement(F,null))},D=n(4),H=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.onLogout()}},{key:"render",value:function(){return r.a.createElement(D.a,{to:"/auth"})}}]),n}(a.Component),M=Object(N.b)(null,(function(e){return{onLogout:function(){return e(C())}}}))(H),q=n(24),W=n(95),P=n(189),z=n(191),B=n(194),V=n(190),G=n(192),J=(n(132),n(90)),$=n.n(J),K=n(86),Y=n.n(K),Q=n(91),X=n.n(Q),Z=(n(133),n(134),function(e){return e.show?r.a.createElement("div",{className:"Backdrop",onClick:e.clicked}):null}),ee=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return e.show!==this.props.show||e.children!==this.props.children}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z,{show:this.props.show,clicked:this.props.modalClosed}),r.a.createElement("div",{className:"Modal",style:{transform:this.props.show?"translateY(0)":"translateY(-100vh)",opacity:this.props.show?"1":"0"}},this.props.children))}}]),n}(a.Component),te=function(e,t){return function(n){Object(u.a)(c,n);var a=Object(m.a)(c);function c(){var e;Object(i.a)(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=a.call.apply(a,[this].concat(n))).state={error:null},e.errorConfirmedHandler=function(){e.setState({error:null})},e}return Object(l.a)(c,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;t.interceptors.request.use((function(t){return e.setState({error:null}),t})),t.interceptors.response.use((function(e){return e}),(function(t){e.setState({error:t})}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ee,{show:this.state.error,modalClosed:this.errorConfirmedHandler},this.state.error?this.state.error.message:null),r.a.createElement(e,this.props))}}]),c}(a.Component)},ne=n(59),ae=n.n(ne),re=(n(135),function(e){return r.a.createElement("div",{className:"Loader"}," Loadin... ")}),ce=new Y.a({bitRate:128});var oe=te(Object(N.b)((function(e){return{username:e.auth.username,userId:e.auth.userId,id:e.rooms.id,room:e.rooms.room,token:e.auth.token,loadRoom:e.rooms.loadRoom,roomName:e.rooms.roomName,friends:e.rooms.friends}}),(function(e){return{message:function(t){return e(A(t))}}}))((function(e){var t=e.socket,n=e.userId,c=e.id,o=e.room,s=e.loadRoom,i=e.roomName,l=e.friends,u=Object(a.useRef)([]),m=Object(a.useRef)(),d=Object(a.useRef)(),p=Object(a.useRef)(),h=Object(a.useState)(!1),b=Object(q.a)(h,2),g=b[0],v=b[1],y=Object(a.useRef)(null),E=Object(a.useRef)(null),j=Object(a.useRef)(),k=Object(a.useRef)(),C=Object(a.useRef)(),_=Object(a.useRef)(),S=Object(a.useRef)(),w=Object(a.useRef)(),T=Object(a.useRef)(),R=Object(a.useRef)(),A=Object(a.useRef)();Object(a.useEffect)((function(){navigator.getUserMedia({audio:!0},(function(){v(!1)}),(function(){v(!0)}))}),[]);var N=function(e){e.preventDefault();var t=document.querySelector("#sms"),a=new FormData;if(E.current){a.append("audio",E.current),a.append("setId",A.current);var r=document.querySelector("#body"),o=f(R.current,!0,"voice",A.current);r.append(o),S.current.style.display="none",_.current.style.display="inline-block",j.current.style.display="inline-block",d.current.style.display="inline-block"}else if(y.current){a.append("photo",y.current),a.append("setId",T.current);var s=document.querySelector("#body"),i=f(w.current,!0,"img",T.current);s.append(i),S.current.style.display="none",_.current.style.display="none",k.current.style.display="inline-block",j.current.style.display="inline-block",d.current.style.display="inline-block"}else a.append("message",t.value),k.current.style.display="inline-block",_.current.style.display="inline-block";a.append("sender",n),a.append("room",c),O.post("/message",a),t.value="",document.getElementById("img").setAttribute("class","hidden"),E.current=null,y.current=null,U.scrollTo({top:1e5,behavior:"smooth"})};Object(a.useEffect)((function(){t&&t.on("sent",(function(e,t,a,r){if(e.endsWith("png")||e.endsWith("jpg")||e.endsWith("PNG")||e.endsWith("JPG")){if(_.current&&(_.current.style.display="inline-block"),r&&T.current&&r.toString()===T.current.toString())return document.querySelector(".".concat(r.toString())).setAttribute("style","background-color:green")}else if(e.endsWith("mp3")||e.endsWith("wav")){if(k.current&&(k.current.style.display="inline-block"),r&&A.current)if(r.toString()===A.current.toString())return document.querySelector(".".concat(r.toString())).setAttribute("style","background-color:green")}var c;c=n===t;var o=document.querySelector("#body"),s=f(e,c,"",r);o.append(s)}))}),[t,n]);var I=null;if(s&&(console.log("hehe"),I=r.a.createElement(re,null)),0!==o.length&&o.docs){var x=document.querySelector("#body"),U=document.createElement("div");U.setAttribute("class","chat__body"),U.setAttribute("id","body"),x&&(x.parentNode.replaceChild(U,x),I=o.docs.map((function(e){var t;return t=parseInt(n)===e.sender,U.scrollTo({top:1e5,behavior:"smooth"}),U.append(f(e.message,t,e.id))})))}var F=null;c&&(F=r.a.createElement("div",{className:"chat__footer"},r.a.createElement("form",null,r.a.createElement("div",{ref:j},r.a.createElement("div",{className:"emoji",ref:m,style:{visibility:"hidden"}},r.a.createElement(ae.a,{onEmojiClick:function(e,t){u.current=[].concat(Object(W.a)(u.current),[t]),d.current.value+=u.current[u.current.length-1].emoji,d.current.value?(k.current.style.display="none",_.current.style.display="none"):(k.current.style.display="inline-block",_.current.style.display="inline-block")},skinTone:ne.SKIN_TONE_MEDIUM_DARK})),r.a.createElement(P.a,{onClick:function(){var e=m.current;e.style.visibility="hidden"===e.style.visibility?"":"hidden"}},r.a.createElement(V.a,null))),r.a.createElement("input",{placeholder:"Type a message",type:"text",id:"sms",ref:d,onChange:function(e){e.target.value?(k.current.style.display="none",_.current.style.display="none"):(k.current.style.display="inline-block",_.current.style.display="inline-block")}}),r.a.createElement("button",{onClick:N,type:"submit"},"Send a message"),r.a.createElement("button",{onClick:N,type:"submit",ref:S},"Send"),r.a.createElement($.a,{className:"start",onClick:function(){var e=document.querySelector(".start"),t=document.querySelector(".end");e.setAttribute("id","hidden"),t.setAttribute("id",""),_.current.style.display="none",j.current.style.display="none",d.current.style.display="none",k.current.style.display="none",g?console.log("Permission Denied"):ce.start().then((function(){p.current=!0})).catch((function(e){return console.error(e)}))},ref:k}),r.a.createElement(X.a,{className:"end",id:"hidden",onClick:function(){var e=document.querySelector(".start"),t=document.querySelector(".end");e.setAttribute("id",""),t.setAttribute("id","hidden"),S.current.style.display="inline-block",ce.stop().getMp3().then((function(e){var t=Object(q.a)(e,2),n=t[0],a=t[1];p.current=!1;var r=URL.createObjectURL(a);R.current=r;var c=(new Date).getTime().toString();A.current="b".concat(c,"c");var o=new File(n,"me-at-thevoice.mp3",{type:a.type,lastModified:Date.now()});E.current=o})).catch((function(e){return console.log(e)}))},ref:C}),y?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{id:"img",alt:"ss",style:{borderRadius:"50%",width:"62px",height:"55px"},className:"hidden"}),r.a.createElement(z.a,{ref:_,variant:"contained",component:"label",style:{borderRadius:"50%"}},r.a.createElement(G.a,null),r.a.createElement("input",{id:"phoo",type:"file",style:{display:"none"},onInput:function(e){if(e.target.files[0]){y.current=e.target.files[0];var t=e.target.files[0],n=new FileReader,a=document.getElementById("img");a.classList.remove("hidden"),a.title=t.name,n.onload=function(e){a.src=e.target.result,w.current=e.target.result;var t=(new Date).getTime().toString();T.current="a".concat(t)},n.readAsDataURL(t)}e.target.files[0]&&(k.current.style.display="none",j.current.style.display="none",d.current.style.display="none",S.current.style.display="inline-block")}}))):r.a.createElement(z.a,{ref:_,variant:"contained",component:"label",style:{borderRadius:"50%"}},r.a.createElement(G.a,null),r.a.createElement("input",{type:"file",style:{display:"none"},onInput:function(e){y.current=e.target.files[0];var t=e.target.files[0],n=new FileReader,a=document.getElementById("img");a.title=t.name,console.log("geg"),n.onload=function(e){a.src=e.target.result,w.current=e.target.result,T.current=(new Date).getTime()},n.readAsDataURL(t),e.target.files[0]&&(console.log("hereaaa"),k.current.style.display="none",j.current.style.display="none",d.current.style.display="none",S.current.style.display="inline-block")}})))));var L=r.a.createElement(re,null);return s||(L=r.a.createElement("div",{className:"chat__body",id:"body"},I)),r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"chat__header"},r.a.createElement(B.a,null),r.a.createElement("div",{className:"chat__headerInfo"},r.a.createElement("h3",null," ",i||"Welcome"," "),r.a.createElement("p",null," ",l?"Members : "+l.map((function(e){return e.username+"  "})):"")),r.a.createElement("div",{className:"chat__headerRight"})),L,F)})),O),se=(n(137),n(92)),ie=n.n(se),le=n(193);n(138);var ue=Object(N.b)((function(e){return{token:e.auth.token}}),(function(e){return{fetchRoom:function(t,n){return e(function(e,t){return function(){var n=Object(y.a)(v.a.mark((function n(a){var r,c;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:"ROOM_START"}),n.next=3,O.get("/room?room=".concat(t,"&&limit=30"),{headers:{authorization:"Bearer ".concat(e)}});case 3:r=n.sent,c=r.data,200!==r.status&&201!==r.status?a(R(c,t)):a(T(c,t));case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,n))}}}))((function(e){var t=e.image,n=e.recieved,a=e.token,c=e.fetchRoom,o=e.id;return r.a.createElement("div",{onClick:function(){!function(e,t){c(e,t)}(a,o)},className:"sidebarChat"},r.a.createElement(B.a,{src:t||""}),r.a.createElement("div",{className:"sidebarChat__info"},r.a.createElement("h2",null,n||"name"),r.a.createElement("p",null,"This is the last message")))}));n(139);var me=Object(N.b)((function(e){return{checkedContacts:e.contacts.checkedContacts}}),(function(e){return{popCons:function(t){return e(function(e){return{type:"POP_CONTACT",contact:e}}(t))},pushCons:function(t){return e(function(e){return{type:"PUSH_CONTACT",contact:e}}(t))}}}))((function(e){var t=e.pushCons,n=e.popCons,c=e.name,o=e.photo,s=e.id,i=Object(a.useState)(!1),l=Object(q.a)(i,2),u=l[0],m=l[1],d=["fa fa-check-circle none"],p=["sidebarContact"];return u&&(d=["fa fa-check-circle dis"],p=["sidebarContact active"]),r.a.createElement("div",{className:p,onClick:function(){return m(!u),void(u?n(s):t(s))}},r.a.createElement(B.a,{src:o}),r.a.createElement("div",{className:"sidebarContact__info"},r.a.createElement("i",{className:d}),r.a.createElement("h2",null,c)))}));var de=Object(N.b)((function(e){return{checkedContacts:e.contacts.checkedContacts,userId:e.auth.userId,rooms:e.rooms.rooms,token:e.auth.token,photo:e.auth.photo,loading:e.rooms.loading,serached:e.rooms.serached}}),(function(e){return{fetchRooms:function(t){return e(w())},clearContacts:function(){return e({type:"CLEAR_CONTACTS"})},searchRoom:function(t,n){return e(function(e,t){return{type:"SEARCH_ROOM",serached:t.filter((function(t){return t.name.startsWith(e)}))}}(t,n))}}}))((function(e){var t=e.contacts,n=e.checkedContacts,c=e.socket,o=e.userId,s=e.rooms,i=e.fetchRooms,l=e.token,u=e.clearContacts,m=e.photo,d=e.loading,p=e.searchRoom,f=e.serached;Object(a.useEffect)((function(){c&&c.on("join-success",(function(e){c.emit("join-room",e),i(l)}))}),[c,i,l]);var h=Object(a.useState)(!1),b=Object(q.a)(h,2),g=b[0],v=b[1],y=r.a.createElement("div",{className:"sidebar__chats"},f.length>0?f.map((function(e){return r.a.createElement(ue,{recieved:e.name,key:e.id,id:e.id})})):s.map((function(e){return r.a.createElement(ue,{recieved:e.name,key:e.id,id:e.id})})));d&&(y=r.a.createElement(re,null)),g&&(y=r.a.createElement("div",{className:"sidebar__contacts"},t.map((function(e){return r.a.createElement(me,{name:e.username,id:e.id,photo:e.photo,key:e.id})}))));var E=null;return g&&(E=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"name"}," Chat Name: ")," ",r.a.createElement("input",{type:"text",id:"room__name"}),r.a.createElement("button",{onClick:function(){var e=document.querySelector("#room__name"),t=n.concat(parseInt(o));c.emit("new-room",e.value,t),v(!1),u()},id:"submit__room"}," ","Submit"," "))),r.a.createElement("div",{className:"sidebar"},r.a.createElement("div",{className:"sidebar__header"},r.a.createElement(B.a,{src:m,alt:"s"}),r.a.createElement("div",{className:"sidebar__headerRight"},r.a.createElement(P.a,{onClick:function(){return v(!g)}},r.a.createElement(ie.a,null)))),r.a.createElement("div",{className:"sidebar__search"},r.a.createElement("div",{className:"sidebar__searchContainer"},r.a.createElement(le.a,null),r.a.createElement("input",{placeholder:"Search or start new chat",type:"text",onChange:function(e){p(e.target.value,s)}}))),y,E)})),pe=n(93),fe=n.n(pe),he=n(30);var be=Object(N.b)((function(e){return{contacts:e.contacts.contacts,userId:e.auth.userId,token:e.auth.token}}),(function(e){return{fetchContacts:function(t){return e(function(){var e=Object(y.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"FETCH_START"}),e.next=3,O.get("/users?paginate=false",{headers:{authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:return n=e.sent,e.next=6,n.data;case 6:a=e.sent,200!==n.status&&201!==n.status?t({type:"FETCH_FAIL",error:a}):t({type:"FETCH_CONTACTS",contacts:a});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},fetchRooms:function(t){return e(w())}}}))((function(e){var t=e.userId,n=e.fetchContacts,c=e.contacts,o=e.fetchRooms,s=e.token,i=Object(a.useState)(),l=Object(q.a)(i,2),u=l[0],m=l[1];return Object(a.useEffect)((function(){n(s)}),[n,s]),Object(a.useEffect)((function(){o(s)}),[s,o]),Object(a.useEffect)((function(){var e=fe.a.connect("".concat("http://localhost:9004"));m(e),e.emit("join",t),e.on("sending",(function(e){}))}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{backgroundColor:"#dadbd3",textAlign:"right"}},r.a.createElement(he.b,{to:"/logout",style:{color:"black",marginRight:"5%"}}," ","Logout"," ")),r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"app__body"},r.a.createElement(de,{contacts:c,socket:u}),r.a.createElement(oe,{socket:u}))))})),ge=(n(172),n(83),n(173),Object(D.g)(Object(N.b)((function(e){return{isAuth:null!==e.auth.token}}),(function(e){return{onTry:function(){return e(function(){var e=Object(y.a)(v.a.mark((function e(t){var n,a,r,c,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("token")){e.next=5;break}t(C()),e.next=17;break;case 5:if(!((a=new Date(localStorage.getItem("expirationDate")))<new Date)){e.next=10;break}t(C()),e.next=17;break;case 10:return r=localStorage.getItem("userId"),e.next=13,O.get("/user",{headers:{authorization:"Bearer ".concat(n)}});case 13:c=e.sent,o=c.data,t(j(n,r,o.photo)),t(_((a.getTime()-(new Date).getTime())/1e3));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}}))((function(e){Object(a.useEffect)((function(){e.onTry()}));var t=null;return t=r.a.createElement(D.d,null,r.a.createElement(D.b,{component:L,path:"/auth"}),r.a.createElement(D.a,{to:"/auth"})),e.isAuth&&(t=r.a.createElement(D.d,null,r.a.createElement(D.b,{exact:!0,component:be,path:"/"}),r.a.createElement(D.b,{exact:!0,component:M,path:"/logout"}),r.a.createElement(D.a,{to:"/"}))),r.a.createElement(r.a.Fragment,null,r.a.createElement("main",null,t))}))));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ve=n(28),ye=n(94),Ee={userId:null,loading:!1,token:null,username:null,error:null,signUp:!1,photo:null},Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_START":return Object(p.a)(Object(p.a)({},e),{},{loading:!0,error:null,signUp:t.signUp});case"AUTH_SUCCESS":return Object(p.a)(Object(p.a)({},e),{},{token:t.token,userId:t.userId,username:t.username,loading:!1,signUp:t.signUp,photo:t.photo});case"AUTH_FAIL":return Object(p.a)(Object(p.a)({},e),{},{loading:!1,error:t.error,signUp:t.signUp});case"LOGOUT":return Object(p.a)(Object(p.a)({},e),{},{token:null,userId:null,username:null,photo:null,error:null});default:return e}},je={contacts:[],loading:!1,checkedContacts:[],error:null},ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_START":return Object(p.a)(Object(p.a)({},e),{},{loading:!0});case"FETCH_FAIL":return Object(p.a)(Object(p.a)({},e),{},{loading:!1,error:t.error});case"FETCH_CONTACTS":return Object(p.a)(Object(p.a)({},e),{},{loading:!1,contacts:t.contacts});case"POP_CONTACT":return Object(p.a)(Object(p.a)({},e),{},{checkedContacts:e.checkedContacts.filter((function(e){return e!==t.contact}))});case"PUSH_CONTACT":return Object(p.a)(Object(p.a)({},e),{},{checkedContacts:e.checkedContacts.concat(t.contact)});case"CLEAR_CONTACTS":return Object(p.a)(Object(p.a)({},e),{},{checkedContacts:[]});default:return e}},Ce={rooms:[],loading:!1,loadRoon:!1,error:null,room:[],id:null,roomName:null,friends:null,serached:[]},_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_ROOM_START":return Object(p.a)(Object(p.a)({},e),{},{loading:!0});case"FETCH_ROOM_SUCCESS":return Object(p.a)(Object(p.a)({},e),{},{rooms:t.rooms,loading:!1,error:null});case"FETCH_ROOM_FAIL":return Object(p.a)(Object(p.a)({},e),{},{error:t.error,loading:!1});case"PUSH_ROOM":return Object(p.a)(Object(p.a)({},e),{},{rooms:e.rooms.concat({name:t.room,friends:t.friends})});case"ROOM_START":return Object(p.a)(Object(p.a)({},e),{},{loadRoon:!0});case"ROOM_FAIL":return Object(p.a)(Object(p.a)({},e),{},{error:t.error,loadRoon:!1,id:t.id});case"ROOM_SUCCESS":return Object(p.a)(Object(p.a)({},e),{},{room:t.room.messages,loadRoon:!1,id:t.id,roomName:t.room.room.name,friends:t.room.room.friends});case"SEARCH_ROOM":return Object(p.a)(Object(p.a)({},e),{},{serached:t.serached});default:return e}},Se=ve.d,we=Object(ve.c)({auth:Oe,contacts:ke,rooms:_e}),Te=Object(ve.e)(we,Se(Object(ve.a)(ye.a)));o.a.render(r.a.createElement(N.a,{store:Te},r.a.createElement(he.a,null,r.a.createElement(ge,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[101,1,2]]]);
//# sourceMappingURL=main.3cb90b34.chunk.js.map